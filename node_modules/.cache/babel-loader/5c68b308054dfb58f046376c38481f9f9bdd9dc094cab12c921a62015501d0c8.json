{"ast":null,"code":"// frontend-service/src/services/api.js\nimport axios from 'axios';\nimport { isTokenExpired, refreshAccessToken, clearTokens } from './auth';\nconst apiClient = axios.create({\n  baseURL: 'http://localhost:8000',\n  //process.env.REACT_APP_API_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\napiClient.interceptors.request.use(async config => {\n  var _document$cookie$spli;\n  let accessToken = sessionStorage.getItem('accessToken');\n  const refreshToken = (_document$cookie$spli = document.cookie.split('; ').find(row => row.startsWith('refreshToken='))) === null || _document$cookie$spli === void 0 ? void 0 : _document$cookie$spli.split('=')[1];\n  if (!accessToken || isTokenExpired(accessToken)) {\n    if (!refreshToken) {\n      console.error('No refresh token found, redirecting to login...');\n      clearTokens();\n      window.location.href = '/login';\n      return Promise.reject(new Error('No refresh token found.'));\n    }\n    try {\n      accessToken = await refreshAccessToken(refreshToken);\n    } catch (error) {\n      console.error('Token refresh failed, redirecting to login...');\n      clearTokens();\n      window.location.href = '/login';\n      return Promise.reject(error);\n    }\n  }\n  config.headers.Authorization = `Bearer ${accessToken}`;\n  return config;\n});\nexport default apiClient;","map":{"version":3,"names":["axios","isTokenExpired","refreshAccessToken","clearTokens","apiClient","create","baseURL","headers","interceptors","request","use","config","_document$cookie$spli","accessToken","sessionStorage","getItem","refreshToken","document","cookie","split","find","row","startsWith","console","error","window","location","href","Promise","reject","Error","Authorization"],"sources":["/Users/pbh7080/Desktop/project/ITeaMoa/frontend-service/src/services/api.js"],"sourcesContent":["// frontend-service/src/services/api.js\nimport axios from 'axios';\nimport { isTokenExpired, refreshAccessToken, clearTokens } from './auth';\n\nconst apiClient = axios.create({\n    baseURL: 'http://localhost:8000', //process.env.REACT_APP_API_URL,\n    headers: {\n        'Content-Type': 'application/json',\n    },\n});\n\napiClient.interceptors.request.use(async (config) => {\n    let accessToken = sessionStorage.getItem('accessToken');\n    const refreshToken = document.cookie.split('; ').find(row => row.startsWith('refreshToken='))\n                          ?.split('=')[1];\n  \n    if (!accessToken || isTokenExpired(accessToken)) {\n      if (!refreshToken) {\n        console.error('No refresh token found, redirecting to login...');\n        clearTokens();\n        window.location.href = '/login';\n        return Promise.reject(new Error('No refresh token found.'));\n      }\n  \n      try {\n        accessToken = await refreshAccessToken(refreshToken);\n      } catch (error) {\n        console.error('Token refresh failed, redirecting to login...');\n        clearTokens();\n        window.location.href = '/login';\n        return Promise.reject(error);\n      }\n    }\n  \n    config.headers.Authorization = `Bearer ${accessToken}`;\n    return config;\n  });\n  \nexport default apiClient;\n"],"mappings":"AAAA;AACA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,cAAc,EAAEC,kBAAkB,EAAEC,WAAW,QAAQ,QAAQ;AAExE,MAAMC,SAAS,GAAGJ,KAAK,CAACK,MAAM,CAAC;EAC3BC,OAAO,EAAE,uBAAuB;EAAE;EAClCC,OAAO,EAAE;IACL,cAAc,EAAE;EACpB;AACJ,CAAC,CAAC;AAEFH,SAAS,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CAAC,MAAOC,MAAM,IAAK;EAAA,IAAAC,qBAAA;EACjD,IAAIC,WAAW,GAAGC,cAAc,CAACC,OAAO,CAAC,aAAa,CAAC;EACvD,MAAMC,YAAY,IAAAJ,qBAAA,GAAGK,QAAQ,CAACC,MAAM,CAACC,KAAK,CAAC,IAAI,CAAC,CAACC,IAAI,CAACC,GAAG,IAAIA,GAAG,CAACC,UAAU,CAAC,eAAe,CAAC,CAAC,cAAAV,qBAAA,uBAAxEA,qBAAA,CACGO,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EAErC,IAAI,CAACN,WAAW,IAAIZ,cAAc,CAACY,WAAW,CAAC,EAAE;IAC/C,IAAI,CAACG,YAAY,EAAE;MACjBO,OAAO,CAACC,KAAK,CAAC,iDAAiD,CAAC;MAChErB,WAAW,CAAC,CAAC;MACbsB,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;MAC/B,OAAOC,OAAO,CAACC,MAAM,CAAC,IAAIC,KAAK,CAAC,yBAAyB,CAAC,CAAC;IAC7D;IAEA,IAAI;MACFjB,WAAW,GAAG,MAAMX,kBAAkB,CAACc,YAAY,CAAC;IACtD,CAAC,CAAC,OAAOQ,KAAK,EAAE;MACdD,OAAO,CAACC,KAAK,CAAC,+CAA+C,CAAC;MAC9DrB,WAAW,CAAC,CAAC;MACbsB,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;MAC/B,OAAOC,OAAO,CAACC,MAAM,CAACL,KAAK,CAAC;IAC9B;EACF;EAEAb,MAAM,CAACJ,OAAO,CAACwB,aAAa,GAAG,UAAUlB,WAAW,EAAE;EACtD,OAAOF,MAAM;AACf,CAAC,CAAC;AAEJ,eAAeP,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}