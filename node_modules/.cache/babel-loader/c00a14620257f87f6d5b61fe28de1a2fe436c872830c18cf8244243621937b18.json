{"ast":null,"code":"// frontend-service/src/services/api.js\nimport axios from 'axios';\nimport { isTokenExpired, refreshAccessToken, clearTokens } from './auth';\nconst apiClient = axios.create({\n  baseURL: 'http://localhost:8000',\n  //process.env.REACT_APP_API_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\napiClient.interceptors.request.use(async config => {\n  var _document$cookie$spli;\n  let accessToken = sessionStorage.getItem('accessToken');\n  const refreshToken = (_document$cookie$spli = document.cookie.split('; ').find(row => row.startsWith('refreshToken='))) === null || _document$cookie$spli === void 0 ? void 0 : _document$cookie$spli.split('=')[1];\n  console.log('Current Access Token:', accessToken);\n  console.log('Current Refresh Token:', refreshToken);\n  if (!accessToken || isTokenExpired(accessToken)) {\n    if (!refreshToken) {\n      console.error('No refresh token found, redirecting to login...');\n      clearTokens();\n      //window.location.href = '/LoginPage';\n      return Promise.reject(new Error('No refresh token found.'));\n    }\n    try {\n      console.log('Refreshing Access Token...');\n      accessToken = await refreshAccessToken(refreshToken);\n    } catch (error) {\n      console.error('Token refresh failed, redirecting to login...');\n      clearTokens();\n      //window.location.href = '/LoginPage';\n      return Promise.reject(error);\n    }\n  }\n  config.headers.Authorization = `Bearer ${accessToken}`;\n  return config;\n});\nexport default apiClient;","map":{"version":3,"names":["axios","isTokenExpired","refreshAccessToken","clearTokens","apiClient","create","baseURL","headers","interceptors","request","use","config","_document$cookie$spli","accessToken","sessionStorage","getItem","refreshToken","document","cookie","split","find","row","startsWith","console","log","error","Promise","reject","Error","Authorization"],"sources":["/Users/pbh7080/Desktop/project/ITeaMoa/frontend-service/src/services/api.js"],"sourcesContent":["// frontend-service/src/services/api.js\nimport axios from 'axios';\nimport { isTokenExpired, refreshAccessToken, clearTokens } from './auth';\n\nconst apiClient = axios.create({\n    baseURL: 'http://localhost:8000', //process.env.REACT_APP_API_URL,\n    headers: {\n        'Content-Type': 'application/json',\n    },\n});\n\napiClient.interceptors.request.use(async (config) => {\n    let accessToken = sessionStorage.getItem('accessToken');\n    const refreshToken = document.cookie.split('; ').find(row => row.startsWith('refreshToken='))\n                        ?.split('=')[1];\n\n    console.log('Current Access Token:', accessToken);\n    console.log('Current Refresh Token:', refreshToken);\n    \n    if (!accessToken || isTokenExpired(accessToken)) {\n        if (!refreshToken) {\n            console.error('No refresh token found, redirecting to login...');\n            clearTokens();\n            //window.location.href = '/LoginPage';\n            return Promise.reject(new Error('No refresh token found.'));\n        }\n\n        try {\n            console.log('Refreshing Access Token...');\n            accessToken = await refreshAccessToken(refreshToken);\n        } catch (error) {\n            console.error('Token refresh failed, redirecting to login...');\n            clearTokens();\n            //window.location.href = '/LoginPage';\n            return Promise.reject(error);\n        }\n    }\n\n    config.headers.Authorization = `Bearer ${accessToken}`;\n    return config;\n});\n\nexport default apiClient;\n"],"mappings":"AAAA;AACA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,cAAc,EAAEC,kBAAkB,EAAEC,WAAW,QAAQ,QAAQ;AAExE,MAAMC,SAAS,GAAGJ,KAAK,CAACK,MAAM,CAAC;EAC3BC,OAAO,EAAE,uBAAuB;EAAE;EAClCC,OAAO,EAAE;IACL,cAAc,EAAE;EACpB;AACJ,CAAC,CAAC;AAEFH,SAAS,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CAAC,MAAOC,MAAM,IAAK;EAAA,IAAAC,qBAAA;EACjD,IAAIC,WAAW,GAAGC,cAAc,CAACC,OAAO,CAAC,aAAa,CAAC;EACvD,MAAMC,YAAY,IAAAJ,qBAAA,GAAGK,QAAQ,CAACC,MAAM,CAACC,KAAK,CAAC,IAAI,CAAC,CAACC,IAAI,CAACC,GAAG,IAAIA,GAAG,CAACC,UAAU,CAAC,eAAe,CAAC,CAAC,cAAAV,qBAAA,uBAAxEA,qBAAA,CACCO,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EAEnCI,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAEX,WAAW,CAAC;EACjDU,OAAO,CAACC,GAAG,CAAC,wBAAwB,EAAER,YAAY,CAAC;EAEnD,IAAI,CAACH,WAAW,IAAIZ,cAAc,CAACY,WAAW,CAAC,EAAE;IAC7C,IAAI,CAACG,YAAY,EAAE;MACfO,OAAO,CAACE,KAAK,CAAC,iDAAiD,CAAC;MAChEtB,WAAW,CAAC,CAAC;MACb;MACA,OAAOuB,OAAO,CAACC,MAAM,CAAC,IAAIC,KAAK,CAAC,yBAAyB,CAAC,CAAC;IAC/D;IAEA,IAAI;MACAL,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAC;MACzCX,WAAW,GAAG,MAAMX,kBAAkB,CAACc,YAAY,CAAC;IACxD,CAAC,CAAC,OAAOS,KAAK,EAAE;MACZF,OAAO,CAACE,KAAK,CAAC,+CAA+C,CAAC;MAC9DtB,WAAW,CAAC,CAAC;MACb;MACA,OAAOuB,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;IAChC;EACJ;EAEAd,MAAM,CAACJ,OAAO,CAACsB,aAAa,GAAG,UAAUhB,WAAW,EAAE;EACtD,OAAOF,MAAM;AACjB,CAAC,CAAC;AAEF,eAAeP,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}