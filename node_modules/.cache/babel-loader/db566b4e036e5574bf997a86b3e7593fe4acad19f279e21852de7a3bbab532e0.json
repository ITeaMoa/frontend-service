{"ast":null,"code":"// frontend-service/src/services/api.js\nimport axios from 'axios';\nimport { isTokenExpired, refreshAccessToken } from './auth';\nconst apiClient = axios.create({\n  baseURL: 'http://localhost:8000',\n  //process.env.REACT_APP_API_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\napiClient.interceptors.request.use(async config => {\n  var _document$cookie$spli;\n  let accessToken = sessionStorage.getItem('accessToken');\n  const refreshToken = (_document$cookie$spli = document.cookie.split('; ').find(row => row.startsWith('refreshToken='))) === null || _document$cookie$spli === void 0 ? void 0 : _document$cookie$spli.split('=')[1];\n  if (isTokenExpired(accessToken)) {\n    try {\n      accessToken = await refreshAccessToken(config.email, refreshToken);\n    } catch (error) {\n      console.error('Token refresh failed, redirecting to login...');\n      window.location.href = '/login'; // Redirect to login on failure\n      return Promise.reject(error);\n    }\n  }\n  config.headers.Authorization = `Bearer ${accessToken}`;\n  return config;\n});\nexport default apiClient;","map":{"version":3,"names":["axios","isTokenExpired","refreshAccessToken","apiClient","create","baseURL","headers","interceptors","request","use","config","_document$cookie$spli","accessToken","sessionStorage","getItem","refreshToken","document","cookie","split","find","row","startsWith","email","error","console","window","location","href","Promise","reject","Authorization"],"sources":["/Users/pbh7080/Desktop/project/ITeaMoa/frontend-service/src/services/api.js"],"sourcesContent":["// frontend-service/src/services/api.js\nimport axios from 'axios';\nimport { isTokenExpired, refreshAccessToken } from './auth';\n\nconst apiClient = axios.create({\n    baseURL: 'http://localhost:8000', //process.env.REACT_APP_API_URL,\n    headers: {\n        'Content-Type': 'application/json',\n    },\n});\n\napiClient.interceptors.request.use(async (config) => {\n    let accessToken = sessionStorage.getItem('accessToken');\n    const refreshToken = document.cookie.split('; ').find(row => row.startsWith('refreshToken='))\n                        ?.split('=')[1];\n\n    if (isTokenExpired(accessToken)) {\n        try {\n            accessToken = await refreshAccessToken(config.email, refreshToken);\n        } catch (error) {\n            console.error('Token refresh failed, redirecting to login...');\n            window.location.href = '/login'; // Redirect to login on failure\n            return Promise.reject(error);\n        }\n    }\n\n    config.headers.Authorization = `Bearer ${accessToken}`;\n    return config;\n});\n\nexport default apiClient;\n"],"mappings":"AAAA;AACA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,cAAc,EAAEC,kBAAkB,QAAQ,QAAQ;AAE3D,MAAMC,SAAS,GAAGH,KAAK,CAACI,MAAM,CAAC;EAC3BC,OAAO,EAAE,uBAAuB;EAAE;EAClCC,OAAO,EAAE;IACL,cAAc,EAAE;EACpB;AACJ,CAAC,CAAC;AAEFH,SAAS,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CAAC,MAAOC,MAAM,IAAK;EAAA,IAAAC,qBAAA;EACjD,IAAIC,WAAW,GAAGC,cAAc,CAACC,OAAO,CAAC,aAAa,CAAC;EACvD,MAAMC,YAAY,IAAAJ,qBAAA,GAAGK,QAAQ,CAACC,MAAM,CAACC,KAAK,CAAC,IAAI,CAAC,CAACC,IAAI,CAACC,GAAG,IAAIA,GAAG,CAACC,UAAU,CAAC,eAAe,CAAC,CAAC,cAAAV,qBAAA,uBAAxEA,qBAAA,CACCO,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EAEnC,IAAIjB,cAAc,CAACW,WAAW,CAAC,EAAE;IAC7B,IAAI;MACAA,WAAW,GAAG,MAAMV,kBAAkB,CAACQ,MAAM,CAACY,KAAK,EAAEP,YAAY,CAAC;IACtE,CAAC,CAAC,OAAOQ,KAAK,EAAE;MACZC,OAAO,CAACD,KAAK,CAAC,+CAA+C,CAAC;MAC9DE,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ,CAAC,CAAC;MACjC,OAAOC,OAAO,CAACC,MAAM,CAACN,KAAK,CAAC;IAChC;EACJ;EAEAb,MAAM,CAACJ,OAAO,CAACwB,aAAa,GAAG,UAAUlB,WAAW,EAAE;EACtD,OAAOF,MAAM;AACjB,CAAC,CAAC;AAEF,eAAeP,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}